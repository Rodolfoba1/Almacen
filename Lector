package Reproductor;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.RandomAccessFile;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.logging.Level;
import java.util.logging.Logger;
public class Lector 
{
    ArrayList<Datos> list = new ArrayList<>();
    Datos nuevos = new Datos();
    public void mostrar()
    {
        for (int i=0; i < list.size(); i++) 
        {
            System.out.println("PistaNombre "+list.get(i).getPistaNombre());
            System.out.println("PistaDireccion "+list.get(i).getPistaDireccion());
            System.out.println("PistaDuracion "+list.get(i).getPistaDuracionMin()+":"+list.get(i).getPistaDuracionSec());
            System.out.println("PistaLetra "+list.get(i).getPistaLetra());
            System.out.println("");
            System.out.println("Album "+list.get(i).getAlbum());
            System.out.println("AlbumNumero "+list.get(i).getAlbumNumero());
            System.out.println("AlbumAño "+list.get(i).getAlbumAño());
            System.out.println("");
            System.out.println("Disquera "+list.get(i).getDisquera());
            System.out.println("Artista "+list.get(i).getArtista());
            System.out.println("Genero "+list.get(i).getGenero());
            System.out.println("");
            System.out.println("EnlacesArtista "+list.get(i).getEnlacesArtista());
            System.out.println("EnlacesDisquera "+list.get(i).getEnlacesDisquera());
            System.out.println("EnlacesOtros "+list.get(i).getEnlacesOtros());
            System.out.println("");
            System.out.println("");
        }
    }
    Guardadatos f = new Guardadatos();
    public void lectura(String ruta) 
    {
        int end;
        int WPUB = 0;
        int TIT2 = 0;
        int TPUB = 0;
        int TPE2 = 0;
        int WOAR = 0;
        int USLT = 0;
        int TRCK = 0;
        int TPOS = 0;
        int TCON = 0;
        int TYER = 0;
        int TPE1 = 0;
        int TALB = 0;
        try 
        {
            RandomAccessFile archivo = new RandomAccessFile(ruta, "r");
            int s = -52;
            int contador = 0;
            //ANTES DE LEER EL ARCHIVO COMPARAMOS SI ES UN ID3
            if ((char) archivo.readByte() == 'I') 
            {
                contador++;
                if ((char) archivo.readByte() == 'D') 
                {
                    contador++;
                    if ((char) archivo.readByte() == '3') 
                    {
                        contador++;
                        byte x = archivo.readByte();
                        contador++;
                        int a = 0, b = 0, c = 0, d = 0;
                        end = 0;
                        /* BUSQUEDA DEL TIT2 [#TIT2 Title/songname/content description]*/
                        while (a != 84 || b != 73 || c != 84 || d != 50) 
                        {
                            a = archivo.readByte();
                            contador++;
                            b = archivo.readByte();
                            contador++;
                            c = archivo.readByte();
                            contador++;
                            d = archivo.readByte();
                            contador++;
                            if (a != 84 || b != 73 || c != 84 || d != 50) 
                            {
                                contador = contador - 3;
                                archivo.seek(contador);
                            }
                            end++;
                            if (end == 2000) 
                            {
                                a = 84;
                                b = 73;
                                c = 84;
                                d = 50;
                            }
                        }
                        if (end < 2000) 
                            TIT2 = contador;
                        else 
                            TIT2 = -1;
                        /* BUSQUEDA DEL TPE2 [#TPE2 Band/orchestra/accompaniment]*/
                        contador = 3;
                        archivo.seek(3);
                        a = 0;
                        b = 0;
                        c = 0;
                        d = 0;
                        end = 0;
                        while (a != 84 || b != 80 || c != 69 || d != 50) 
                        {
                            a = archivo.readByte();
                            contador++;
                            b = archivo.readByte();
                            contador++;
                            c = archivo.readByte();
                            contador++;
                            d = archivo.readByte();
                            contador++;
                            if (a != 84 || b != 80 || c != 69 || d != 50) 
                            {
                                contador = contador - 3;
                                archivo.seek(contador);
                            }
                            end++;
                            if (end == 2000) 
                            {
                                a = 84;
                                b = 80;
                                c = 69;
                                d = 50;
                            }
                        }
                        if (end < 2000) 
                            TPE2 = contador;
                        else 
                            TPE2 = -1;
                        /* BUSQUEDA DONDE TERMINA EL TALB*/
                        contador = 3;
                        archivo.seek(3);
                        a = 0;
                        b = 0;
                        c = 0;
                        d = 0;
                        end = 0;
                        /* [#TALB Album/Movie/Show title]*/
                        while (a != 84 || b != 65 || c != 76 || d != 66)
                        {
                            a = archivo.readByte();
                            contador++;
                            b = archivo.readByte();
                            contador++;
                            c = archivo.readByte();
                            contador++;
                            d = archivo.readByte();
                            contador++;
                            if (a != 84 || b != 65 || c != 76 || d != 66) 
                            {
                                contador = contador - 3;
                                archivo.seek(contador);
                            }
                            end++;
                            if (end == 2000) 
                            {
                                a = 84;
                                b = 65;
                                c = 76;
                                d = 66;
                            }
                        }
                        if (end < 2000) 
                            TALB = contador;
                        else 
                            TALB = -1;
                        //BUSCA DONDE TERMINA EL TPE1 [#TPE1 Lead performer(s)/Soloist(s)] //
                        contador = 3;
                        archivo.seek(3);
                        a = 0;
                        b = 0;
                        c = 0;
                        d = 0;
                        end = 0;
                        while (a != 84 || b != 80 || c != 69 || d != 49) 
                        {
                            a = archivo.readByte();
                            contador++;

                            b = archivo.readByte();
                            contador++;

                            c = archivo.readByte();
                            contador++;

                            d = archivo.readByte();
                            contador++;
                            if (a != 84 || b != 80 || c != 69 || d != 49) 
                            {
                                contador = contador - 3;
                                archivo.seek(contador);
                            }
                            end++;
                            if (end == 2000) 
                            {
                                a = 84;
                                b = 80;
                                c = 69;
                                d = 49;
                            }
                        }
                        if (end < 2000) 
                            TPE1 = contador;
                        else 
                            TPE1 = -1;
                        //                  buscar donde termina TPE1         //
                        contador = 3;
                        archivo.seek(3);
                        a = 0;
                        b = 0;
                        c = 0;
                        d = 0;
                        end = 0;
                        while (a != 84 || b != 80 || c != 85 || d != 66)//TPE1
                        {
                            a = archivo.readByte();
                            contador++;
                            b = archivo.readByte();
                            contador++;
                            c = archivo.readByte();
                            contador++;
                            d = archivo.readByte();
                            contador++;
                            if (a != 84 || b != 80 || c != 85 || d != 66) 
                            {
                                contador = contador - 3;
                                archivo.seek(contador);
                            }
                            end++;
                            if (end == 2000) 
                            {
                                a = 84;
                                b = 80;
                                c = 85;
                                d = 66;
                            }
                        }
                        if (end < 2000) 
                            TPUB = contador;
                        else 
                            TPUB = -1;
                        contador = 3;
                        archivo.seek(3);
                        a = 0;
                        b = 0;
                        c = 0;
                        d = 0;
                        end = 0;
                        while (a != 84 || b != 89 || c != 69 || d != 82)//TYER
                        {
                            a = archivo.readByte();
                            contador++;
                            b = archivo.readByte();
                            contador++;
                            c = archivo.readByte();
                            contador++;
                            d = archivo.readByte();
                            contador++;
                            if (a != 84 || b != 89 || c != 69 || d != 82) 
                            {
                                contador = contador - 3;
                                archivo.seek(contador);
                            }
                            end++;
                            if (end == 2000) 
                            {
                                a = 84;
                                b = 89;
                                c = 69;
                                d = 82;
                            }
                        }
                        if (end < 2000) 
                            TYER = contador;///termina etiqueta TIT2
                        else 
                            TYER = -1;
                        // System.out.println("TYER "+TYER+" " +archivo.readByte());
                        contador = 3;
                        archivo.seek(3);
                        a = 0;
                        b = 0;
                        c = 0;
                        d = 0;
                        end = 0;
                        while (a != 84 || b != 67 || c != 79 || d != 78)//TCON
                        {
                            a = archivo.readByte();
                            contador++;
                            b = archivo.readByte();
                            contador++;
                            c = archivo.readByte();
                            contador++;
                            d = archivo.readByte();
                            contador++;
                            if (a != 84 || b != 67 || c != 79 || d != 78) 
                            {
                                contador = contador - 3;
                                archivo.seek(contador);
                            }
                            end++;
                            if (end == 2000) 
                            {
                                a = 84;
                                b = 67;
                                c = 79;
                                d = 78;
                            }
                        }
                        if (end < 2000) 
                            TCON = contador;///termina etiqueta TIT2
                        else 
                            TCON = -1;
                        contador = 3;
                        archivo.seek(3);
                        a = 0;
                        b = 0;
                        c = 0;
                        d = 0;
                        end = 0;
                        while (a != 84 || b != 80 || c != 79 || d != 83)//TPOS
                        {
                            a = archivo.readByte();
                            contador++;
                            b = archivo.readByte();
                            contador++;
                            c = archivo.readByte();
                            contador++;
                            d = archivo.readByte();
                            contador++;
                            if (a != 84 || b != 80 || c != 79 || d != 83) 
                            {
                                contador = contador - 3;
                                archivo.seek(contador);
                            }
                            end++;
                            if (end == 99999) 
                            {
                                a = 84;
                                b = 80;
                                c = 79;
                                d = 83;
                            }
                        }
                        if (end < 99999) 
                            TPOS = contador;///termina etiqueta TIT2
                        else 
                            TPOS = -1;
                        contador = 3;
                        archivo.seek(3);
                        a = 0;
                        b = 0;
                        c = 0;
                        d = 0;
                        end = 0;
                        while (a != 84 || b != 82 || c != 67 || d != 75)//TPOS
                        {
                            a = archivo.readByte();
                            contador++;
                            b = archivo.readByte();
                            contador++;
                            c = archivo.readByte();
                            contador++;
                            d = archivo.readByte();
                            contador++;
                            if (a != 84 || b != 82 || c != 67 || d != 75) 
                            {
                                contador = contador - 3;
                                archivo.seek(contador);
                            }
                            end++;
                            if (end == 99999) 
                            {
                                a = 84;
                                b = 82;
                                c = 67;
                                d = 75;
                            }
                        }
                        if (end < 99999) 
                            TRCK = contador;///termina etiqueta TIT2
                        else 
                            TRCK = -1;
                        //System.out.println("TRCK "+TRCK+" " +archivo.readByte());
                        contador = 3;
                        archivo.seek(3);
                        a = 0;
                        b = 0;
                        c = 0;
                        d = 0;
                        end = 0;
                        while (a != 85 || b != 83 || c != 76 || d != 84)//TPOS
                        {
                            a = archivo.readByte();
                            contador++;
                            b = archivo.readByte();
                            contador++;
                            c = archivo.readByte();
                            contador++;
                            d = archivo.readByte();
                            contador++;
                            if (a != 85 || b != 83 || c != 76 || d != 84) 
                            {
                                contador = contador - 3;
                                archivo.seek(contador);
                            }
                            end++;
                            if (end == 99999) 
                            {
                                a = 85;
                                b = 83;
                                c = 76;
                                d = 84;
                            }
                        }
                        if (end < 99999) 
                            USLT = contador;///termina etiqueta TIT2
                        else 
                            USLT = -1;
                        contador = 3;
                        archivo.seek(3);
                        a = 0;
                        b = 0;
                        c = 0;
                        d = 0;
                        end = 0;
                        while (a != 87 || b != 79 || c != 65 || d != 82)//TPOS
                        {
                            a = archivo.readByte();
                            contador++;
                            b = archivo.readByte();
                            contador++;
                            c = archivo.readByte();
                            contador++;
                            d = archivo.readByte();
                            contador++;
                            if (a != 87 || b != 79 || c != 65 || d != 82) 
                            {
                                contador = contador - 3;
                                archivo.seek(contador);
                            }
                            end++;
                            if (end == 99999) 
                            {
                                a = 87;
                                b = 79;
                                c = 65;
                                d = 82;
                            }
                        }
                        if (end < 99999) 
                            WOAR = contador;///termina etiqueta TIT2
                        else 
                            WOAR = -1;
                        //System.out.println("WOAR "+WOAR+" " +archivo.readByte());
                        contador = 3;
                        archivo.seek(3);
                        a = 0;
                        b = 0;
                        c = 0;
                        d = 0;
                        end = 0;
                        while (a != 87 || b != 80 || c != 85 || d != 66)//TPOS
                        {
                            a = archivo.readByte();
                            contador++;
                            b = archivo.readByte();
                            contador++;
                            c = archivo.readByte();
                            contador++;
                            d = archivo.readByte();
                            contador++;
                            if (a != 87 || b != 80 || c != 85 || d != 66) 
                            {
                                contador = contador - 3;
                                archivo.seek(contador);
                            }
                            end++;
                            if (end == 99999) 
                            {
                                a = 87;
                                b = 80;
                                c = 85;
                                d = 66;
                            }
                        }
                        if (end < 99999) 
                            WPUB = contador;///termina etiqueta TIT2
                        else 
                            WPUB = -1;
                        //System.out.println("WPUB "+WPUB+" " +archivo.readByte());
                    }
                }
            }
            /////pagina del disquera
            String genero = "";
            if (TCON != -1) 
            {
                archivo.seek(TCON);
                byte aux = 0;
                byte longitud = 0;
                for (int i = 0; i <= 3; i++) 
                    longitud = archivo.readByte();
                for (int i = 0; i < 2; i++) 
                    archivo.readByte();
                for (int i = 0; i < longitud; i++) 
                {
                    aux = archivo.readByte();
                    if (aux > 31 && aux < 124) 
                        genero = genero + (char) aux;
                }
                // System.out.println("Genero " + genero);
                nuevos.setGenero(genero);
            }
//            else 
//                genero = "Desconocido";
            String pagD = "";
            if (WPUB != -1) 
            {
                archivo.seek(WPUB);
                byte aux = 0;
                byte longitud = 0;
                for (int i = 0; i <= 3; i++) 
                    longitud = archivo.readByte();
                for (int i = 0; i < 2; i++) 
                    archivo.readByte();
                for (int i = 0; i < longitud; i++) 
                {
                    aux = archivo.readByte();
                    if (aux > 31 && aux < 124) 
                        pagD = pagD + (char) aux;
                }
                //System.out.println("Pagina disquera " + pagD);
                nuevos.setEnlacesDisquera(pagD);
            } 
//            else 
//                pagD = "Desconocido";
            String pagA = "";
            if (WOAR != -1) 
            {
                archivo.seek(WOAR);
                byte aux = 0;
                byte longitud = 0;
                for (int i = 0; i <= 3; i++) 
                    longitud = archivo.readByte();
                for (int i = 0; i < 2; i++) 
                    archivo.readByte();
                for (int i = 0; i < longitud; i++) 
                {
                    aux = archivo.readByte();
                    if (aux > 31 && aux < 124) 
                        pagA = pagA + (char) aux;
                }
                //System.out.println("Pagina " + pagA);
                nuevos.setEnlacesArtista(pagA);
            } 
//            else 
//                pagA = "Desconocido";
            String letra = "";
            if (USLT != -1) 
            {
                archivo.seek(USLT);
                int longitud = archivo.readInt() + 2;
                byte aux = 0;
                for (int i = 0; i < longitud; i++) 
                {
                    aux = archivo.readByte();
                    if (aux > 31 && aux < 124) 
                        letra = letra + (char) aux;
                    if (aux == 0 || aux == 12 || aux == 10) 
                        letra = letra + (char) aux;
                }
                //System.out.println("Letra " + letra);
                nuevos.setPistaLetra(letra);
            } 
//            else 
//                letra = "Desconocido";
            String track = "";
            if (TRCK != -1) 
            {
                archivo.seek(TRCK);
                byte aux = 0;
                short longitud = 0;
                for (int i = 0; i <= 3; i++) 
                    longitud = archivo.readByte();
                for (int i = 0; i < 2; i++) 
                    archivo.readByte();
                for (int i = 0; i < longitud; i++) 
                {
                    aux = archivo.readByte();
                    if (aux > 31 && aux < 124) 
                        track = track + (char) aux;
                }
                //System.out.println("Pista " + track);
                
            } 
//            else 
//                track = "Desconocido";
            String año = "";
            if (TYER != -1)
            {
                archivo.seek(TYER);
                byte aux = 0;
                byte longitud = 0;
                for (int i = 0; i <= 3; i++) 
                    longitud = archivo.readByte();
                for (int i = 0; i < 2; i++) 
                    archivo.readByte();
                for (int i = 0; i < longitud; i++) 
                {
                    aux = archivo.readByte();
                    if (aux > 31 && aux < 124) 
                        año = año + (char) aux;
                }
                //System.out.println("año " + año);
                nuevos.setAlbumAño(aux);
            } 
//            else 
//                año = "Desconocido";
            String NoA = "";
            if (TPOS != -1) 
            {
                archivo.seek(TPOS);
                byte aux = 0;
                byte longitud = 0;
                for (int i = 0; i <= 3; i++) 
                    longitud = archivo.readByte();
                for (int i = 0; i < 2; i++) 
                    archivo.readByte();
                for (int i = 0; i < longitud; i++) 
                {
                    aux = archivo.readByte();
                    if (aux > 31 && aux < 124) 
                        NoA = NoA + (char) aux;
                }
//                System.out.println("No. Album " + NoA);
                nuevos.setAlbumNumero(NoA);
            } 
//            else 
//                NoA = "Desconocido";
            String alb = "";
            if (TALB != -1) 
            {
                archivo.seek(TALB);
                byte aux = 0;
                byte longitud = 0;
                for (int i = 0; i <= 3; i++) 
                    longitud = archivo.readByte();
                for (int i = 0; i < 2; i++) 
                    archivo.readByte();
                for (int i = 0; i < longitud; i++) 
                {
                    aux = archivo.readByte();
                    if (aux > 31 && aux < 124) 
                        alb = alb + (char) aux;
                }
                //System.out.println("album " + alb);
                nuevos.setAlbum(alb);
            } 
//            else 
//                alb = "Desconocido";
            String art1 = "";
            if (TPE1 != -1) 
            {
                archivo.seek(TPE1);
                byte aux = 0;
                byte longitud = 0;
                for (int i = 0; i <= 3; i++) 
                    longitud = archivo.readByte();
                for (int i = 0; i < 2; i++) 
                    archivo.readByte();
                for (int i = 0; i < longitud; i++) 
                {
                    aux = archivo.readByte();
                    if (aux > 31 && aux < 124) 
                        art1 = art1 + (char) aux;
                }
                //System.out.println("artista 1 " + art1);
                nuevos.setArtista(art1);
            } 
//            else 
//                art1 = "Desconocido";
            String cancion = "";
            if (TIT2 != -1) 
            {
                archivo.seek(TIT2);
                byte aux = 0;
                byte longitud = 0;
                for (int i = 0; i <= 3; i++) 
                    longitud = archivo.readByte();
                for (int i = 0; i < 2; i++) 
                    archivo.readByte();
                for (int i = 0; i < longitud; i++) 
                {
                    aux = archivo.readByte();
                    if (aux > 31 && aux < 124) 
                        cancion = cancion + (char) aux;
                }
                //System.out.println("Cancion " + cancion);
                nuevos.setPistaNombre(cancion);
            } 
//            else 
//                cancion = "Desconocido";
            String disquera = "";
            if (TPUB != -1) 
            {
                archivo.seek(TPUB);
                byte aux = 0;
                byte longitud = 0;
                for (int i = 0; i <= 3; i++) 
                    longitud = archivo.readByte();
                for (int i = 0; i < 2; i++) 
                    archivo.readByte();
                for (int i = 0; i < longitud; i++) 
                {
                    aux = archivo.readByte();
                    if (aux > 31 && aux < 124) 
                        disquera = disquera + (char) aux;
                }
                //System.out.println("Disquera " + disquera);
                nuevos.setDisquera(disquera);
            } 
            else 
                disquera = "Desconocido";
            //nuevaa.agregarAlInicio(ruta,cancion,art1,alb,disquera,letra,pagA,pagD,genero,track,NoA,año);
            list.add(nuevos);
            archivo.close();
        }
        catch (FileNotFoundException ex) 
        {
            Logger.getLogger(Lector.class.getName()).log(Level.SEVERE, null, ex);
        } 
            catch (IOException ex) 
        {
            Logger.getLogger(Lector.class.getName()).log(Level.SEVERE, null, ex);
        }
        f.escribir(list);
    }
}
